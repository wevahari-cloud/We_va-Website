module.exports=[70342,a=>{"use strict";var b=a.i(37936),c=a.i(94758),d=a.i(37137),e=a.i(93321),f=a.i(30385),g=a.i(18558);async function h(){try{return await c.db.select().from(d.gallery).orderBy((0,f.desc)(d.gallery.createdAt))}catch(a){return console.error("Failed to fetch gallery images:",a),[]}}async function i(){try{let a=await c.db.select().from(d.gallery).orderBy((0,f.desc)(d.gallery.createdAt)),b=(await c.db.select({id:d.events.id,title:d.events.title,imageUrl:d.events.posterUrl,images:d.events.images,category:d.events.category,createdAt:d.events.createdAt}).from(d.events).orderBy((0,f.desc)(d.events.createdAt))).filter(a=>a.imageUrl&&""!==a.imageUrl.trim()||Array.isArray(a.images)&&a.images.length>0&&a.images.some(a=>"string"==typeof a&&""!==a.trim())),e=[...a.map(a=>({...a,id:`gallery-${a.id}`,type:"gallery"})),...b.flatMap(a=>{let b=[];return a.imageUrl&&b.push({id:`event-${a.id}-poster`,title:a.title,imageUrl:a.imageUrl,category:a.category,createdAt:a.createdAt,type:"event",eventId:a.id}),Array.isArray(a.images)&&a.images.forEach((c,d)=>{"string"==typeof c&&""!==c.trim()&&b.push({id:`event-${a.id}-extra-${d}`,title:`${a.title} - Photo ${d+1}`,imageUrl:c,category:a.category,createdAt:a.createdAt,type:"event",eventId:a.id})}),b})];return e.sort((a,b)=>{let c=new Date(a.createdAt||0);return new Date(b.createdAt||0).getTime()-c.getTime()}),e}catch(a){return console.error("Failed to fetch public gallery images:",a),[]}}async function j(a){try{return await c.db.insert(d.gallery).values(a),(0,g.revalidatePath)("/gallery"),(0,g.revalidatePath)("/admin/gallery"),{success:!0}}catch(a){return console.error("Failed to add gallery image:",a),{success:!1,error:"Database insert failed"}}}async function k(a){try{return await c.db.delete(d.gallery).where((0,e.eq)(d.gallery.id,a)),(0,g.revalidatePath)("/gallery"),(0,g.revalidatePath)("/admin/gallery"),{success:!0}}catch(a){return console.error("Failed to delete gallery image:",a),{success:!1,error:"Database delete failed"}}}(0,a.i(13095).ensureServerEntryExports)([h,i,j,k]),(0,b.registerServerReference)(h,"00f9a7a584e89020dd5388211223be80bbf39d5ef5",null),(0,b.registerServerReference)(i,"00b68c86ecc3a2cecfe1d56ad4e012c5137233f128",null),(0,b.registerServerReference)(j,"404c663949dff536d7117ad4a62f83a61b609de4a1",null),(0,b.registerServerReference)(k,"40a754ebeea1af3b68804c3a4b47560b936b735fdd",null),a.s(["addGalleryImage",()=>j,"deleteGalleryImage",()=>k,"getGalleryImages",()=>h,"getPublicGalleryImages",()=>i])},16887,a=>{"use strict";var b=a.i(70342);a.s([],12960),a.i(12960),a.s(["00f9a7a584e89020dd5388211223be80bbf39d5ef5",()=>b.getGalleryImages,"40a754ebeea1af3b68804c3a4b47560b936b735fdd",()=>b.deleteGalleryImage],16887)}];

//# sourceMappingURL=_d5362ffb._.js.map